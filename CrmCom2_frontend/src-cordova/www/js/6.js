(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{7568:function(e,t,s){"use strict";var a=s("ad7a"),o=s.n(a);o.a},"94eb":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"customers"}},[s("h6",[e._v("\n    Gestione del cliente\n    "),s("strong",[e._v(e._s(e.customerDescription))])]),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/new.png"},on:{click:e.newCustomer}}),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/save.png"},on:{click:e.saveCustomer}}),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/delete.png"},on:{click:e.deleteCustomer}}),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/exit.png"},on:{click:e.exit}}),s("q-form",{ref:"customerForm",staticClass:"q-gutter-md"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-toggle",{attrs:{label:"Azienda"},model:{value:e.isCompany,callback:function(t){e.isCompany=t},expression:"isCompany"}})],1),s("div",{staticClass:"col"},[s("q-checkbox",{attrs:{label:"Da fatturare"},model:{value:e.selectedCustomer.businnessflag,callback:function(t){e.$set(e.selectedCustomer,"businnessflag",t)},expression:"selectedCustomer.businnessflag"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Nome"},model:{value:e.selectedCustomer.firstname,callback:function(t){e.$set(e.selectedCustomer,"firstname",t)},expression:"selectedCustomer.firstname"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Cognome"},model:{value:e.selectedCustomer.lastname,callback:function(t){e.$set(e.selectedCustomer,"lastname",t)},expression:"selectedCustomer.lastname"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Codice Fiscale"},model:{value:e.selectedCustomer.codfis,callback:function(t){e.$set(e.selectedCustomer,"codfis",t)},expression:"selectedCustomer.codfis"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Indirizzo"},model:{value:e.selectedCustomer.address,callback:function(t){e.$set(e.selectedCustomer,"address",t)},expression:"selectedCustomer.address"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Cap"},model:{value:e.selectedCustomer.postalcode,callback:function(t){e.$set(e.selectedCustomer,"postalcode",t)},expression:"selectedCustomer.postalcode"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"CittÃ "},model:{value:e.selectedCustomer.city,callback:function(t){e.$set(e.selectedCustomer,"city",t)},expression:"selectedCustomer.city"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Stato"},model:{value:e.selectedCustomer.state,callback:function(t){e.$set(e.selectedCustomer,"state",t)},expression:"selectedCustomer.state"}})],1)]),e.isCompany?s("div",{attrs:{id:"companyFields"}},[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Denominazione Azienda"},model:{value:e.selectedCustomer.company,callback:function(t){e.$set(e.selectedCustomer,"company",t)},expression:"selectedCustomer.company"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Indirizzo Azienda"},model:{value:e.selectedCustomer.companyaddress,callback:function(t){e.$set(e.selectedCustomer,"companyaddress",t)},expression:"selectedCustomer.companyaddress"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Telefono aziendale",type:"tel"},model:{value:e.selectedCustomer.companyphone,callback:function(t){e.$set(e.selectedCustomer,"companyphone",t)},expression:"selectedCustomer.companyphone"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Partita IVA"},model:{value:e.selectedCustomer.vatcode,callback:function(t){e.$set(e.selectedCustomer,"vatcode",t)},expression:"selectedCustomer.vatcode"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Codice Univoco SDI"},model:{value:e.selectedCustomer.sdicode,callback:function(t){e.$set(e.selectedCustomer,"sdicode",t)},expression:"selectedCustomer.sdicode"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Company PEC",type:"email"},model:{value:e.selectedCustomer.companypec,callback:function(t){e.$set(e.selectedCustomer,"companypec",t)},expression:"selectedCustomer.companypec"}})],1)])]):e._e(),s("div",{staticClass:"row .offset-md-4"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Email",type:"email"},model:{value:e.selectedCustomer.email,callback:function(t){e.$set(e.selectedCustomer,"email",t)},expression:"selectedCustomer.email"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Tel. Mobile",type:"tel"},model:{value:e.selectedCustomer.mobilephone,callback:function(t){e.$set(e.selectedCustomer,"mobilephone",t)},expression:"selectedCustomer.mobilephone"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Tel. Fisso",type:"tel"},model:{value:e.selectedCustomer.phone,callback:function(t){e.$set(e.selectedCustomer,"phone",t)},expression:"selectedCustomer.phone"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Nome Utente"},model:{value:e.selectedCustomer.username,callback:function(t){e.$set(e.selectedCustomer,"username",t)},expression:"selectedCustomer.username"}})],1),s("div",{staticClass:"row"},[s("q-input",{attrs:{label:"Password",filled:"",type:e.isPwd?"password":"text"},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}]),model:{value:e.selectedCustomer.password,callback:function(t){e.$set(e.selectedCustomer,"password",t)},expression:"selectedCustomer.password"}})],1)])]),e.contracts?s("div",[s("q-table",{attrs:{title:"Contratti",data:e.contracts,columns:e.columnsTableContracts,"row-key":"id","virtual-scroll":"",pagination:e.pagination,"rows-per-page-options":[0]},on:{"update:pagination":function(t){e.pagination=t},"row-click":e.openContract},scopedSlots:e._u([{key:"header",fn:function(t){return[s("q-tr",{attrs:{props:t}},[s("q-th",{attrs:{"auto-width":""}}),e._l(t.cols,(function(a){return s("q-th",{key:a.name,attrs:{props:t}},[e._v(e._s(a.label))])}))],2)]}},{key:"body",fn:function(t){return[s("q-tr",{class:t.row.state,attrs:{props:t}},[s("q-td",{attrs:{"auto-width":""}},[s("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"/img/actions/open.png"},on:{click:function(s){return e.openContract(t.row)}}}),s("img",{staticStyle:{width:"32px",height:"32px",xfill:"green"},attrs:{src:"/img/actions/unlocked.png"},on:{click:function(s){return e.activateContract(t.row)}}}),s("img",{staticStyle:{width:"32px",height:"32px",xfill:"red"},attrs:{src:"/img/actions/locked.png"},on:{click:function(s){return e.suspendContract(t.row)}}}),s("img",{staticStyle:{width:"32px",height:"32px",xfill:"gray"},attrs:{src:"/img/actions/delete.png"},on:{click:function(s){return e.deleteContract(t.row)}}})]),e._l(t.cols,(function(a){return s("q-td",{key:a.name,attrs:{props:t}},[e._v(e._s(a.value))])}))],2)]}}],null,!1,2662501898)})],1):e._e()],1)},o=[],c=(s("e01a"),s("c973")),i=s.n(c),n=s("2f62"),l={data(){return{isPwd:!0,isCompany:!1,selectedCustomer:{},selectedContract:{},contracts:[],contractClassStyleRow:"",pagination:{rowsPerPage:0},columnsTableContracts:[{name:"actions",label:"Azioni"},{name:"Stato",label:"state",field:e=>e.state},{name:"description",label:"Descrizione",field:e=>e.description,sortable:!0},{name:"address",label:"Indirizzo",field:e=>e.address,sortable:!0},{name:"duration",label:"Durata",field:e=>e.duration},{name:"createdAt",label:"Data inserimento",field:e=>e.createdAt}],columnsTableDevices:[{name:"description",label:"Descrizione",field:e=>e.description,sortable:!0},{name:"ipv4",label:"Ip",field:e=>e.address,sortable:!0},{name:"mac",label:"Mac",field:e=>e.duration},{name:"Stato",label:"state",field:e=>e.state}]}},methods:{openContract:function(e){this.$store.commit("changeContract",e),this.$router.push("/Contract")},activateContract:function(e){e.state="active",this.$axios.post("/adminarea/contract/update",{contract:e}).then(e=>{"OK"===e.data.status&&(this.selectedContract=e.data.contract,this.$store.commit("changeContract",this.selectedContract))}).catch(e=>{console.log(e)})},suspendContract:function(e){e.state="suspended",this.$axios.post("/adminarea/contract/update",{contract:e}).then(e=>{"OK"===e.data.status&&(this.selectedContract=e.data.contract,this.$store.commit("changeContract",this.selectedContract))}).catch(e=>{console.log(e)})},deleteContract:function(e){const t=confirm("Confermi la cancellazione?");return t?(console.log("Delete confirmed"),"cancellato"):""},getCustomerData:function(){this.$store.state.customer&&(this.selectedCustomer=Object.assign({},this.$store.state.customer),""===this.selectedCustomer.vatcode?this.isCompany=!1:this.isCompany=!0,console.log("Customer"),console.log(this.selectedCustomer),this.getCustomerContracts())},getCustomerContracts:function(){this.$store;this.showCustomerSearch=!0,this.$axios.post("/adminarea/contract/get_all_by_customer",{idCustomer:this.selectedCustomer.id}).then(e=>{"OK"===e.data.status&&(this.contracts=e.data.contracts)}).catch(e=>{console.log(e)})},changeCustomerType:function(){!1===this.isCompanyBtn.value?(this.selectedCustomer.vatcode="",this.isCompanyBtn.value=!0,this.isCompanyBtn.caption="<span><i class='fa fa-industry'></i> Azienda</span>"):!0===this.isCompanyBtn.value&&(this.selectedCustomer.vatcode="",this.isCompanyBtn.value=!1,this.isCompanyBtn.caption="<span><i class='fa fa-home'></i> Privato</span>")},newCustomer:function(){this.selectedCustomer={},this.contracts=[],this.selectedContract={},this.$store.commit("changeCustomer",this.selectedCustomer)},saveCustomer(){var e=this;return i()((function*(){const t=!0;t?e.$axios.post("/adminarea/customer/update",{customer:e.selectedCustomer}).then(t=>{"OK"===t.data.status&&(e.selectedCustomer=t.data.customer,e.$store.commit("changeCustomer",e.selectedCustomer),e.makeToast(t.data.msg),e.getCustomerData(),alert("Cliente inserito"))}).catch(e=>{console.log(e)}):alert("Dati errati controlla i campi inseriti")}))()},deleteCustomer:function(){const e=confirm("Confermi la cancellazione?");e&&this.$axios.post("/adminarea/customer/delete",{customer:this.selectedCustomer}).then(e=>{"OK"===e.data.status&&(this.selectedCustomer=e.data.customer,this.$store.commit("changeCustomer",this.selectedCustomer),this.makeToast(e.data.msg),this.getCustomerData())}).catch(e=>{console.log(e)})},exit:function(){this.$router.push("/AdminHome")},makeToast(e){this.$q.notify({color:"green-4",textColor:"white",icon:"info",message:e})}},mounted(){this.getCustomerData()},computed:Object(n["b"])({user:"user",customer:"customer",customerDescription(){const e=this.customer;return e.vatcode&&""!==e.vatcode?e.company:e.lastname&&e.firstname?e.lastname+" "+e.firstname:"Ricerca o inserisci un nuovo cliente"}})},r=l,d=(s("7568"),s("2877")),u=s("0378"),m=s("9564"),p=s("8f8e"),C=s("27f9"),h=s("0016"),f=s("eaac"),v=s("bd08"),b=s("357e"),g=s("db86"),y=s("eebe"),x=s.n(y),w=Object(d["a"])(r,a,o,!1,null,"1bf4a74a",null);t["default"]=w.exports;x()(w,"components",{QForm:u["a"],QToggle:m["a"],QCheckbox:p["a"],QInput:C["a"],QIcon:h["a"],QTable:f["a"],QTr:v["a"],QTh:b["a"],QTd:g["a"]})},ad7a:function(e,t,s){}}]);