(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{a225:function(e,t,s){},d2d7:function(e,t,s){"use strict";var a=s("a225"),i=s.n(a);i.a},d843:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"user"}},[s("h5",[e._v("Gestione utenti sistema")]),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/new.png"},on:{click:function(t){return e.newUser()}}}),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/save.png"},on:{click:function(t){return e.saveUser()}}}),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/delete.png"},on:{click:function(t){return e.deleteUser()}}}),s("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:"/img/actions/exit.png"},on:{click:function(t){return e.exit()}}}),s("q-form",{ref:"userForm",staticClass:"q-gutter-md"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Nome"},model:{value:e.selectedUser.firstname,callback:function(t){e.$set(e.selectedUser,"firstname",t)},expression:"selectedUser.firstname"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Cognome"},model:{value:e.selectedUser.lastname,callback:function(t){e.$set(e.selectedUser,"lastname",t)},expression:"selectedUser.lastname"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Codice fiscale"},model:{value:e.selectedUser.codfis,callback:function(t){e.$set(e.selectedUser,"codfis",t)},expression:"selectedUser.codfis"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Indirizzo"},model:{value:e.selectedUser.address,callback:function(t){e.$set(e.selectedUser,"address",t)},expression:"selectedUser.address"}})],1)]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Email"},model:{value:e.selectedUser.email,callback:function(t){e.$set(e.selectedUser,"email",t)},expression:"selectedUser.email"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Mobile phone"},model:{value:e.selectedUser.mobilephone,callback:function(t){e.$set(e.selectedUser,"mobilephone",t)},expression:"selectedUser.mobilephone"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Username"},model:{value:e.selectedUser.username,callback:function(t){e.$set(e.selectedUser,"username",t)},expression:"selectedUser.username"}})],1),s("div",{staticClass:"col"},[s("q-input",{attrs:{label:"Password"},model:{value:e.selectedUser.password,callback:function(t){e.$set(e.selectedUser,"password",t)},expression:"selectedUser.password"}})],1),s("div",{staticClass:"col"},[s("q-select",{attrs:{label:"Ruolo",options:e.roles},on:{input:e.changeRole},model:{value:e.selectedRole,callback:function(t){e.selectedRole=t},expression:"selectedRole"}})],1)])]),s("q-table",{attrs:{title:"Utenti",data:e.users,columns:e.columnsTableUsers,"row-key":"id","virtual-scroll":"",pagination:e.pagination,"rows-per-page-options":[5,10,15]},on:{"update:pagination":function(t){e.pagination=t},"row-click":e.openUser},scopedSlots:e._u([{key:"header",fn:function(t){return[s("q-tr",{attrs:{props:t}},[s("q-th",{attrs:{"auto-width":""}}),e._l(t.cols,(function(a){return s("q-th",{key:a.name,attrs:{props:t}},[e._v(e._s(a.label))])}))],2)]}},{key:"body",fn:function(t){return[s("q-tr",{class:t.row.state,attrs:{props:t}},[s("q-td",{attrs:{"auto-width":""}},[s("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"/img/actions/open.png"},on:{click:function(s){return e.openUser(t.row)}}}),s("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"/img/actions/unlocked.png"},on:{click:function(s){return e.activateUser(t.row)}}}),s("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"/img/actions/locked.png"},on:{click:function(s){return e.suspendUser(t.row)}}}),s("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:"/img/actions/delete.png"},on:{click:function(s){return e.deleteUser(t.row)}}})]),e._l(t.cols,(function(a){return s("q-td",{key:a.name,attrs:{props:t}},[e._v(e._s(a.value))])}))],2)]}}])})],1)},i=[],l=(s("a434"),s("2f62")),n={data(){return{selectedUser:{},selectedRole:{},users:[],pagination:{rowsPerPage:0},roles:[{label:"Ufficio",value:"manager",description:"Ufficio azienda"},{label:"Tecnico interno",value:"technician",description:"Tecnico azienda"},{label:"Installatore esterno",value:"installer",description:"Installatore esterno"},{label:"Commerciale",value:"seller",description:"Rappresentante commerciale esterno"},{label:"Administrator",value:"admin",description:"Amministrazione sistema"}],columnsTableUsers:[{name:"actions",label:"Azioni"},{name:"firstname",label:"Nome",field:e=>e.firstname,sortable:!0},{name:"lastname",label:"Cognome",field:e=>e.lastname,sortable:!0},{name:"username",label:"Indirizzo",field:e=>e.username,sortable:!0},{name:"phone",label:"Telefono",field:e=>e.mobilephone,sortable:!0},{name:"email",label:"Email",field:e=>e.email,sortable:!0},{name:"createdAt",label:"Data inserimento",field:e=>e.createdAt,sortable:!0}]}},methods:{newUser:function(){this.selectedUser={}},openUser:function(e){this.selectedUser=e,this.roles.forEach(t=>{t.value===e.role&&(this.selectedRole=t)})},saveUser:function(){console.log(this.selectedUser),this.$axios.post("/adminarea/user/update",{user:this.selectedUser}).then(e=>{"OK"===e.data.status?(this.selectedUser=e.data.user,this.makeToast(e.data.msg)):this.makeToast(e.data.msg)}).catch(e=>{console.log(e)})},deleteUser:function(e){const t=confirm("Confermi la cancellazione?");t&&this.$axios.post("/adminarea/user/delete",{user:e}).then(t=>{"OK"===t.data.status?(this.users.forEach((t,s,a)=>{t.id===e.id&&this.users.splice(s,1)}),this.selectedService={},this.makeToast(t.data.msg)):this.makeToast(t.data.msg)}).catch(e=>{console.log(e)})},getUserData:function(){this.selectedUser=Object.assign({},this.$store.state.user),this.getAllUsers()},getAllUsers:function(){this.$axios.post("/adminarea/user/getall",{}).then(e=>{"OK"===e.data.status&&(this.users=e.data.users,this.makeToast(e.data.msg))}).catch(e=>{console.log(e)})},activateUser:function(e){e.state="active",this.$axios.post("/adminarea/user/update",{user:e}).then(e=>{"OK"===e.data.status&&(this.selectedUser=e.data.user,this.makeToast(e.data.msg))}).catch(e=>{console.log(e)})},suspendUser:function(e){e.state="suspended",this.$axios.post("/adminarea/user/update",{user:e}).then(e=>{"OK"===e.data.status&&(this.selectedUser=e.data.user,this.makeToast(e.data.msg))}).catch(e=>{console.log(e)})},changeRole(){this.selectedUser.role=this.selectedRole.value},exit:function(){this.$router.push("/AdminHome")},makeToast(e){this.$q.notify({color:"green-4",textColor:"white",icon:"info",message:e})}},computed:Object(l["b"])({user:"user"}),created(){this.getAllUsers()}},o=n,r=(s("d2d7"),s("2877")),c=s("0378"),d=s("27f9"),u=s("ddd8"),m=s("eaac"),p=s("bd08"),h=s("357e"),f=s("db86"),g=s("eebe"),b=s.n(g),U=Object(r["a"])(o,a,i,!1,null,"83b63b00",null);t["default"]=U.exports;b()(U,"components",{QForm:c["a"],QInput:d["a"],QSelect:u["a"],QTable:m["a"],QTr:p["a"],QTh:h["a"],QTd:f["a"]})}}]);