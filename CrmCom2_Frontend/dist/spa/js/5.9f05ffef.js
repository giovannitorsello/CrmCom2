(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{0:function(e,t){},2:function(e,t){},"2c42":function(e,t,a){},3:function(e,t){},4:function(e,t){},5:function(e,t){},6:function(e,t){},b252:function(e,t,a){"use strict";a("2c42")},e53e:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"customers"}},[a("h5",[e._v("Inserimento guidato cliente ("+e._s(e.uuid)+")")]),1==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v(" Tipo di cliente privato o azienda?\n  ")]):e._e(),2==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v(" Inserisci i dati del cliente\n  ")]):e._e(),3==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v(" Indirizzo postale cliente (domicilio)\n  ")]):e._e(),4==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v(" Contatti telefono ed email\n  ")]):e._e(),5==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v(" Seleziona i servizi da attivare e\n    l'indirizzo completo del contratto.\n  ")]):e._e(),6==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v(" Documento di identità cliente\n  ")]):e._e(),7==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v("Codice fiscale cliente\n  ")]):e._e(),8==e.step?a("h6",[a("b",[e._v("Configurazione contratto:")]),e._v("Dati finali")]):e._e(),a("div",{staticStyle:{"padding-bottom":"100px"},attrs:{id:"dataFormDiv"}},[a("ValidationObserver",{scopedSlots:e._u([{key:"default",fn:function(t){return[1==e.step?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col-auto"},[a("q-btn-toggle",{attrs:{"toggle-color":"primary","no-caps":"",rounded:"",unelevated:"",options:[{label:"Privato",value:!1},{label:"Azienda",value:!0}]},model:{value:e.isCompany,callback:function(t){e.isCompany=t},expression:"isCompany"}})],1)])]):e._e(),2==e.step?a("div",[e.isCompany?a("div",{attrs:{id:"companyFields"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Denominazone Azienda",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Denominazione Azienda"},model:{value:e.selectedCustomer.company,callback:function(t){e.$set(e.selectedCustomer,"company",t)},expression:"selectedCustomer.company"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Indirizzo Sede Azienda",immediate:"",rules:"required|address"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Indirizzo Sede Azienda"},model:{value:e.selectedCustomer.companyaddress,callback:function(t){e.$set(e.selectedCustomer,"companyaddress",t)},expression:"selectedCustomer.companyaddress"}},[a("a",[e._v("Aiuto sulla compilazione")])]),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Telefono principale aziendale",immediate:"",rules:"required|phone"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Telefono principale aziendale",type:"tel"},model:{value:e.selectedCustomer.companyphone,callback:function(t){e.$set(e.selectedCustomer,"companyphone",t)},expression:"selectedCustomer.companyphone"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Partita IVA",rules:"required|vatcode"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Partita IVA"},model:{value:e.selectedCustomer.vatcode,callback:function(t){e.$set(e.selectedCustomer,"vatcode",t)},expression:"selectedCustomer.vatcode"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Codice univoco SDI",rules:"required|alpha_num"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Codice Univoco SDI"},model:{value:e.selectedCustomer.sdicode,callback:function(t){e.$set(e.selectedCustomer,"sdicode",t)},expression:"selectedCustomer.sdicode"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Email PEC",rules:"required|email"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Email PEC",type:"email"},model:{value:e.selectedCustomer.companypec,callback:function(t){e.$set(e.selectedCustomer,"companypec",t)},expression:"selectedCustomer.companypec"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)])]):e._e(),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[e.isCompany?a("h6",[e._v("\n              Dati amministratore azienda (obbligatori)\n            ")]):e._e(),e.isCompany?e._e():a("h6",[e._v("\n              Dati intestatario contratto (obbligatori)\n            ")])])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Nome",immediate:"",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Nome"},model:{value:e.selectedCustomer.firstname,callback:function(t){e.$set(e.selectedCustomer,"firstname",t)},expression:"selectedCustomer.firstname"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Cognome",immediate:"",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Cognome"},model:{value:e.selectedCustomer.lastname,callback:function(t){e.$set(e.selectedCustomer,"lastname",t)},expression:"selectedCustomer.lastname"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Codice Fiscale",immediate:"",rules:"required|codfis"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Codice Fiscale"},model:{value:e.selectedCustomer.codfis,callback:function(t){e.$set(e.selectedCustomer,"codfis",t)},expression:"selectedCustomer.codfis"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)])]):e._e(),3==e.step?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Indirizzo",immediate:"",rules:"required|address"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Indirizzo"},nativeOn:{focusout:function(t){return e.customerAddressChange()}},model:{value:e.selectedCustomer.address,callback:function(t){e.$set(e.selectedCustomer,"address",t)},expression:"selectedCustomer.address"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"CAP",immediate:"",rules:"required|alpha_num"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"CAP"},model:{value:e.selectedCustomer.postalcode,callback:function(t){e.$set(e.selectedCustomer,"postalcode",t)},expression:"selectedCustomer.postalcode"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Città",immediate:"",rules:"required|alpha"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Città"},model:{value:e.selectedCustomer.city,callback:function(t){e.$set(e.selectedCustomer,"city",t)},expression:"selectedCustomer.city"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Stato",immediate:"",rules:"required|alpha"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Stato"},model:{value:e.selectedCustomer.state,callback:function(t){e.$set(e.selectedCustomer,"state",t)},expression:"selectedCustomer.state"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)])]):e._e(),4==e.step?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Email",immediate:"",rules:"required|email"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Email",type:"email"},model:{value:e.selectedCustomer.email,callback:function(t){e.$set(e.selectedCustomer,"email",t)},expression:"selectedCustomer.email"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Tel. Mobile",immediate:"",rules:"required|phone"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Tel. Mobile",type:"tel"},model:{value:e.selectedCustomer.mobilephone,callback:function(t){e.$set(e.selectedCustomer,"mobilephone",t)},expression:"selectedCustomer.mobilephone"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)}),a("ValidationProvider",{attrs:{name:"Tel. Fisso",immediate:"",rules:"required|phone"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Tel. Fisso",type:"tel"},model:{value:e.selectedCustomer.phone,callback:function(t){e.$set(e.selectedCustomer,"phone",t)},expression:"selectedCustomer.phone"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)])]):e._e(),5==e.step?a("div",[a("div",{staticClass:"row",staticStyle:{width:"100%"}},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Indirizzo esecuzione contratto",immediate:"",rules:"required|address"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Indirizzo esecuzione contratto"},nativeOn:{focusout:function(t){return e.contractAddressChange()}},model:{value:e.selectedContract.address,callback:function(t){e.$set(e.selectedContract,"address",t)},expression:"selectedContract.address"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Indirizzo fatturazione contratto",immediate:"",rules:"required|address"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Indirizzo fatturazione contratto"},nativeOn:{focusout:function(t){return e.invoiceAddressChange()}},model:{value:e.selectedContract.invoiceAddress,callback:function(t){e.$set(e.selectedContract,"invoiceAddress",t)},expression:"selectedContract.invoiceAddress"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Città fatturazione contratto",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Città fatturazione contratto"},model:{value:e.selectedContract.invoiceCity,callback:function(t){e.$set(e.selectedContract,"invoiceCity",t)},expression:"selectedContract.invoiceCity"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"CAP fatturazione contratto",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"CAP fatturazione contratto"},model:{value:e.selectedContract.invoiceCAP,callback:function(t){e.$set(e.selectedContract,"invoiceCAP",t)},expression:"selectedContract.invoiceCAP"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Provincia fatturazione",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Provincia fatturazione"},model:{value:e.selectedContract.invoiceProvince,callback:function(t){e.$set(e.selectedContract,"invoiceProvince",t)},expression:"selectedContract.invoiceProvince"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"row",staticStyle:{width:"100%"}},[a("div",{staticClass:"col"},[a("q-select",{attrs:{filled:"",label:"Categoria",options:e.serviceCategories},on:{input:e.changeCategory},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}}),a("q-table",{staticStyle:{width:"100%"},attrs:{title:"Servizi",data:e.serviceTemplates,columns:e.columnsTableServiceTemplates,"row-key":"id",selection:"multiple",selected:e.selectedServicesTemplate},on:{"update:selected":[function(t){e.selectedServicesTemplate=t},e.getValueSelectedServices]}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[e._v("\n            Costi di attivazione iva esclusa:\n            "+e._s(e.valueSelectedServices.activationPrice)+"\n          ")])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[e._v("\n            Importo iva esclusa: "+e._s(e.valueSelectedServices.price)+"\n          ")]),a("div",{staticClass:"col"},[e._v("Importo iva: "+e._s(e.valueSelectedServices.vat))]),a("div",{staticClass:"col"},[e._v("\n            Importo totale: "+e._s(e.valueSelectedServices.total)+"\n          ")])])]):e._e(),6==e.step?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Numero documento",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Numero documento",type:"tel"},model:{value:e.selectedCustomer.numci,callback:function(t){e.$set(e.selectedCustomer,"numci",t)},expression:"selectedCustomer.numci"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[e.fromCamera?a("q-btn",{staticStyle:{width:"300px"},attrs:{color:"primary",label:"Carta identità retro (camera)"},on:{click:e.captureCiFront}},[a("img",{staticStyle:{width:"100px"},attrs:{src:e.imageCiFront}})]):e._e(),e.fromCamera?e._e():a("q-uploader",{staticStyle:{"max-width":"300px"},attrs:{"auto-upload":"",factory:e.uploadCiFront,accept:".jpg","max-file-size":"2048000",label:"Acquisizione da file (solo jpg)"}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[e.fromCamera?a("q-btn",{staticStyle:{width:"300px"},attrs:{color:"primary",label:"Carta identità retro (camera)"},on:{click:e.captureCiBack}},[a("img",{staticStyle:{width:"100px"},attrs:{src:e.imageCiBack}})]):e._e(),e.fromCamera?e._e():a("q-uploader",{staticStyle:{"max-width":"300px"},attrs:{"auto-upload":"",factory:e.uploadCiBack,accept:".jpg","max-file-size":"2048000",label:"Acquisizione da file (solo jpg)"}})],1)])]):e._e(),7==e.step?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Codice fiscale",immediate:"",rules:"required|codfis"},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.errors;return[a("q-input",{attrs:{label:"Codice fiscale",type:"codfis"},model:{value:e.selectedCustomer.codfis,callback:function(t){e.$set(e.selectedCustomer,"codfis",t)},expression:"selectedCustomer.codfis"}}),a("span",{staticClass:"error"},[e._v(e._s(s[0]))])]}}],null,!0)})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[e.fromCamera?a("q-btn",{staticStyle:{width:"300px"},attrs:{color:"primary",label:"Codice fiscale fronte (camera)"},on:{click:e.captureCfFront}},[a("img",{staticStyle:{width:"100px"},attrs:{src:e.imageCfFront}})]):e._e(),e.fromCamera?e._e():a("q-uploader",{staticStyle:{"max-width":"300px"},attrs:{"auto-upload":"",factory:e.uploadCfFront,"max-file-size":"2048000",accept:".jpg",label:"Acquisizione da file (solo jpg)"}})],1)]),a("div",{staticClass:"row",staticStyle:{with:"100%"}},[a("div",{staticClass:"col"},[e.fromCamera?a("q-btn",{staticStyle:{width:"300px"},attrs:{color:"primary",label:"Codice fiscale retro (camera)"},on:{click:e.captureCfBack}},[a("img",{staticStyle:{width:"100px"},attrs:{src:e.imageCfBack}})]):e._e(),e.fromCamera?e._e():a("q-uploader",{staticStyle:{"max-width":"300px"},attrs:{"auto-upload":"",factory:e.uploadCfBack,"max-file-size":"2048000",accept:".jpg",label:"Acquisizione da file (solo jpg)"}})],1)])]):e._e(),8==e.step?a("div",[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-btn",{on:{click:function(t){e.pagePdf--}}},[e._v(" Pg. prec. ")]),a("q-btn",{on:{click:function(t){e.pagePdf++}}},[e._v(" Pg. succ. ")])],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("q-btn",{attrs:{color:"primary",icon:"mail",label:"Invia per email al cliente"},on:{click:e.sendFinalDocumentByEmail}}),a("q-btn",{attrs:{color:"primary",icon:"document",label:"Visualizza"},on:{click:e.openFinalDocument}})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("pdf",{staticStyle:{display:"inline-block",width:"50%"},attrs:{src:e.fileFinalDocument,page:e.pagePdf}})],1)])]):e._e(),9==e.step?a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("Signature",{attrs:{uuid:e.uuid}}),a("q-btn",{attrs:{color:"primary",icon:"document",label:"Salva il contratto definitivamente"},on:{click:function(t){return e.saveContract()}}})],1)]):e._e(),a("div",{staticClass:"barButtons",attrs:{id:"buttons"}},[a("q-btn",{staticClass:"bottomLeft",on:{click:e.prevStep}},[e._v("Indietro")]),a("q-btn",{staticClass:"bottomRight",attrs:{disabled:t.invalid},on:{click:e.nextStep}},[e._v("Avanti")])],1)]}}])})],1),a("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.helpAddress,callback:function(t){e.helpAddress=t},expression:"helpAddress"}},[a("q-card",{staticClass:"bg-teal text-white",staticStyle:{width:"300px"}},[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("\n          Istruzioni sulla compilazione dell'indirizzo\n        ")])]),a("q-card-section",{staticClass:"q-pt-none"},[a("p",[e._v("\n          Il formato è\n          "),a("b",[e._v("[Frazione] Via o Piazza, numero, CAP, Città, Provincia")])]),a("ul",[a("p",[e._v("\n            Dopo la virgola va un solo spazio. La virgola è attaccata alla\n            parola precedente.\n          ")]),a("p",[e._v("\n            Il numero richiede solo cifre alfa-numeriche, NON scrivere n. o N.\n          ")]),a("p",[e._v("\n            La provincia richiede solo due caratteri maiuscoli senza parentesi\n          ")])])]),a("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"OK"}})],1)],1)],1)],1)},i=[],o=(a("e01a"),a("2f62")),r=a("4360"),l=a("7bb1"),n=a("2ee0"),c=a("858e"),d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"20px"}},[a("p",[e._v("Firma qui")]),a("div",{ref:"canvasContainer"},[a("canvas",{ref:"signatureCanvas",staticStyle:{border:"1px solid #000000"},attrs:{width:"500",height:"200"}})]),a("q-btn",{attrs:{color:"red",label:"Cancella"},on:{click:e.deleteCanvasSignature}}),a("q-btn",{attrs:{color:"teal",label:"Salva"},on:{click:e.saveCanvasSignature}}),a("p",[e._v(e._s(e.xpos)+" -- "+e._s(e.ypos))]),a("p",[e._v(e._s(e.touchForce)+" -- "+e._s(e.azimuthAngle))])],1)},u=[],m={name:"Signature",props:["uuid"],data(){return{xpos:0,ypos:0,last_xpos:0,last_ypos:0,pressure:0,azimuthAngle:0,touchForce:0,event:null,canvas:null}},mounted(){const e=this;this.canvas=this.$refs.signatureCanvas;var t=this.canvas.getContext("2d"),a=this.$refs.canvasContainer,s=getComputedStyle(a);this.canvas.width=parseInt(s.getPropertyValue("width")),this.canvas.height=parseInt(s.getPropertyValue("height")),this.canvas.addEventListener("touchmove",(function(a){a.preventDefault(),e.touchForce=a.targetTouches[a.targetTouches.length-1].force,e.azimuthAngle=a.targetTouches[a.targetTouches.length-1].azimuthAngle,e.touchForce>5e-4&&(e.last_xpos=e.xpos,e.last_ypos=e.ypos,e.xpos=a.targetTouches[a.targetTouches.length-1].pageX-this.offsetLeft,e.ypos=a.targetTouches[a.targetTouches.length-1].pageY-this.offsetTop,t.beginPath(),t.lineWidth=8*e.touchForce,t.moveTo(e.last_xpos,e.last_ypos),t.lineTo(e.xpos,e.ypos),t.closePath(),t.stroke())}),!1),this.canvas.addEventListener("touchstart",(function(t){t.preventDefault(),e.touchForce=t.targetTouches[t.targetTouches.length-1].force,e.azimuthAngle=t.targetTouches[t.targetTouches.length-1].azimuthAngle,e.touchForce>.001&&(e.xpos=t.targetTouches[t.targetTouches.length-1].pageX-this.offsetLeft,e.ypos=t.targetTouches[t.targetTouches.length-1].pageY-this.offsetTop,canvas.beginPath(),canvas.arc(e.xpos,e.ypos,8*e.touchForce,0,2*Math.PI,!0),canvas.stroke(),e.last_xpos=e.xpos,e.last_ypos=e.ypos)}),!1),t.lineWidth=5,t.lineJoin="round",t.lineCap="round"},methods:{deleteCanvasSignature(){var e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),e.beginPath(),e.arc(100,100,8,0,2*Math.PI,!0),e.stroke()},saveCanvasSignature(){var e=this,t=this.canvas.toDataURL("image/png");this.$axios.post("/adminarea/registration/signature",{uuid:this.uuid,signatureData:t}).then((function(t){e.makeToast(t.data.msg,t.data.status)}))},makeToast(e,t){"OK"===t?this.$q.notify({color:"green-4",textColor:"white",icon:"info",message:e}):this.$q.notify({color:"red-4",textColor:"white",icon:"error",message:e})}}},p=m,v=a("2877"),C=a("9c40"),h=a("eebe"),f=a.n(h),g=Object(v["a"])(p,d,u,!1,null,null,null),b=g.exports;f()(g,"components",{QBtn:C["a"]});var _=a("81c3");const{Camera:y}=_["b"];var S={data(){return{step:1,stepMax:9,fileFinalDocument:"",pagePdf:1,fromCamera:!0,helpAddress:!1,isCompany:!1,serviceCategories:[],selectedCategory:{label:"Internet",value:"Internet",icon:""},serviceTemplates:[],selectedCustomer:{},selectedContract:{},selectedServicesTemplate:[],valueSelectedServices:{activationPrice:0,price:0,vat:0,total:0},columnsTableServiceTemplates:[{name:"actions",label:"Azioni"},{name:"description",label:"Descrizione",field:"description",sortable:!0},{name:"code",label:"Codice",field:"code",sortable:!0},{name:"unit",label:"Unità",field:"unit",sortable:!0},{name:"activationPrice",label:"Costo attivazione",field:"activationPrice",sortable:!0},{name:"price",label:"Prezzo",field:"price",sortable:!0},{name:"createdAt",label:"Data inserimento",field:"createdAt",sortable:!0},{name:"updatedAt",label:"Aggiornato il",field:"updatedAt",sortable:!0}],imageCfFront:"",imageCfBack:"",imageCiFront:"",imageCiBack:"",uuid:""}},methods:{nextStep(){this.step<this.stepMax&&this.step++,8==this.step&&this.generateFinalDocument()},prevStep(){this.step>=2&&this.step--},saveContract(){this.$axios.post("/adminarea/registration/save_contract",{customer:this.selectedCustomer,contract:this.selectedContract,services:this.selectedServicesTemplate}).then((e=>{"OK"===e.data.status&&(console.log(this.fileFinalDocument),this.makeToast(e.data.msg))})).catch((e=>{console.log(e),this.makeToast("Si è verificato un errore")}))},generateFinalDocument(){this.selectedCustomer.uuid=this.uuid,this.selectedContract.signature=this.uuid,this.selectedContract&&(this.selectedContract.objData||(this.selectedContract.objData={}),this.selectedContract.objData.valueSelectedServices=this.valueSelectedServices),this.$axios.post("/adminarea/registration/generate_final_document",{customer:this.selectedCustomer,contract:this.selectedContract,services:this.selectedServicesTemplate}).then((e=>{"OK"===e.data.status&&(this.fileFinalDocument=e.data.results.urlFinalDocument,this.pagePdf=1,console.log(this.fileFinalDocument),this.makeToast(e.data.msg))})).catch((e=>{console.log(e),this.makeToast("Si è verificato un errore")}))},openFinalDocument(){window.open(this.fileFinalDocument)},sendFinalDocumentByEmail(){this.selectedCustomer.uuid=this.uuid,this.$axios.post("/adminarea/registration/send_final_document",{customer:this.selectedCustomer,contract:this.selectedContract}).then((e=>{"OK"===e.data.status?(console.log(e.data.results.infoEmail),this.makeToast(e.data.msg)):this.makeToast("Si è verificato un errore.")})).catch((e=>{console.log(e),this.makeToast("Si è verificato un errore")}))},getValueSelectedServices:function(){var e=0,t=0,a=0,s=0;this.valueSelectedServices={price:0,vat:0,total:0},this.selectedServicesTemplate.forEach(((i,o,r)=>{if(s+=i.activationPrice,e+=i.price,t+=i.price*i.vat/100,a=e+t,o===r.length-1){const i=new Intl.NumberFormat("it-IT",{style:"currency",currency:"EUR",minimumFractionDigits:2});e=i.format(e),t=i.format(t),a=i.format(a),s=i.format(s),this.valueSelectedServices={activationPrice:s,price:e,vat:t,total:a}}}))},changeCategory:function(){this.$store;this.$axios.post("/adminarea/serviceTemplate/getByCategory",{category:this.selectedCategory}).then((e=>{"OK"===e.data.status&&(this.serviceTemplates=e.data.serviceTemplates,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},getAllServiceCategories:function(){this.$axios.post("/adminarea/serviceTemplate/getAllServiceCategories",{}).then((e=>{"OK"===e.data.status&&(e.data.serviceCategories.forEach((e=>{this.serviceCategories.push({label:e.description,value:e.value,icon:""})})),this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},getAllServiceTemplates(){this.$axios.post("/adminarea/serviceTemplate/getall",{}).then((e=>{"OK"===e.data.status&&(this.serviceTemplates=e.data.serviceTemplates,console.log(this.serviceTemplates),this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},contractAddressChange(){if(this.selectedContract.invoiceAddress=this.selectedContract.address,this.selectedContract.address&&this.selectedContract.address.length>3){var e=this.selectedContract.address.split(",");this.selectedContract.invoiceCAP=e[2],this.selectedContract.invoiceCity=e[3],this.selectedContract.invoiceProvince=e[4]}},customerAddressChange(){if(this.selectedCustomer&&this.selectedCustomer.address.length>3){var e=this.selectedCustomer.address.split(",");this.selectedCustomer.invoiceCAP=e[2],this.selectedCustomer.invoiceCity=e[3],this.selectedCustomer.invoiceProvince=e[4],this.selectedCustomer.state="ITALY"}},invoiceAddressChange(){if(this.selectedContract.invoiceAddress&&this.selectedContract.invoiceAddress.length>3){var e=this.selectedContract.invoiceAddress.split(",");this.selectedContract.invoiceCAP=e[2],this.selectedContract.invoiceCity=e[3],this.selectedContract.invoiceProvince=e[4]}},captureCiFront(){y.getPhoto({width:600,height:350,quality:100,allowEditing:!0,resultType:_["a"].base64}).then((e=>{this.imageCiFront="data:image/png;base64, "+e.base64String,this.uploadIdentityDocumentImage("CiFront-"+this.uuid,e.base64String)})).catch((e=>console.log("No image: "+e)))},captureCiBack(){y.getPhoto({width:600,height:350,quality:100,allowEditing:!0,resultType:_["a"].base64}).then((e=>{this.imageCiBack="data:image/png;base64, "+e.base64String,this.uploadIdentityDocumentImage("CiBack-"+this.uuid,e.base64String)})).catch((e=>console.log("No image: "+e)))},captureCfFront(){y.getPhoto({width:600,height:350,quality:100,allowEditing:!0,resultType:_["a"].base64}).then((e=>{this.imageCfFront="data:image/png;base64, "+e.base64String,this.uploadIdentityDocumentImage("CfFront-"+this.uuid,e.base64String)})).catch((e=>console.log("No image: "+e)))},captureCfBack(){y.getPhoto({width:600,height:350,quality:100,allowEditing:!0,resultType:_["a"].base64}).then((e=>{this.imageCfBack="data:image/png;base64, "+e.base64String,this.uploadIdentityDocumentImage("CfBack-"+this.uuid,e.base64String)})).catch((e=>console.log("No image: "+e)))},uploadCiFront(e){let t="CiFront-"+this.uuid+".jpg";this.uploadIdentityDocumentFile(t,e)},uploadCiBack(e){let t="CiBack-"+this.uuid+".jpg";this.uploadIdentityDocumentFile(t,e)},uploadCfFront(e){let t="CfFront-"+this.uuid+".jpg";this.uploadIdentityDocumentFile(t,e)},uploadCfBack(e){let t="CfBack-"+this.uuid+".jpg";this.uploadIdentityDocumentFile(t,e)},uploadIdentityDocumentImage(e,t){let a=new FormData;a.append("imageName",e),a.append("file",t),this.$axios.post("/adminarea/upload/identity_document/image",a,{header:{"Content-Type":"image/png"}}).then((e=>{"OK"===e.data.status&&this.makeToast(e.data.msg)})).catch((e=>{console.log(e),this.makeToast("Si è verificato un errore")}))},uploadIdentityDocumentFile(e,t){let a=new FormData;a.append("fileName",e),a.append("file",t[0]),this.$axios.post("/adminarea/upload/identity_document/file",a,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{"OK"===e.data.status&&this.makeToast(e.data.msg)})).catch((e=>{console.log(e),this.makeToast("Si è verificato un errore")}))},getUuid(){this.$axios.post("/adminarea/get_uuid",{}).then((e=>{"OK"===e.data.status&&(this.uuid=e.data.results.uuid)})).catch((e=>{console.log(e)}))},initCustomerDebugValues(){this.selectedCustomer={uuid:this.uuid,firstname:"Giovani",lastname:"Torsello",email:"giovanni.torsello@gmail.com",pec:"giovanni.torsello@pec.it",numci:"0000000000",codfis:"TRSGNN73H26I549A",phone:"3939241987",mobilephone:"3939241987",address:"Via Pasubio, 16, 73010, Soleto, LE",postalcode:"73010",city:"Soleto",state:"ITALY",company:"WIFINETCOM SRL",companyphone:"0833599327",companyaddress:"Via Agnesi, 16, 73054, Cssarano, LE",companypec:"wifinetcom@pec.it",vatcode:"03686220751",sdicode:"AAAAA",username:"giovanni.torsello@gmail.com",password:"1234",onetimetemppassword:"00000",businessflag:1},this.selectedContract={address:"Via Pasubio, 16, 73010, Soleto, LE",invoiceAddress:"Via Pasubio, 16, 73010, Soleto, LE",invoiceCity:"Soleto",invoiceCAP:"73010",invoiceProvince:"LE"}},makeToast(e){this.$q.notify({color:"green-4",textColor:"white",icon:"info",message:e})}},mounted(){n["a"].setup(),this.getAllServiceTemplates(),this.getAllServiceCategories(),this.getUuid(),this.selectedCustomer.uuid=this.uuid},computed:Object(o["b"])({user:"user",customer:"customer",contract:"contract"}),components:{ValidationProvider:l["b"],ValidationObserver:l["a"],pdf:c["a"],Signature:b},beforeRouteEnter(e,t,a){var s=r["a"].state.user;console.log(s),"admin"===s.role||"manager"===s.role||"technician"===s.role||"installer"===s.role||"seller"===s.role?a():a("/Login")}},k=S,x=(a("b252"),a("6a67")),q=a("27f9"),z=a("ddd8"),P=a("eaac"),T=a("ee89"),w=a("24e8"),A=a("f09f"),F=a("a370"),I=a("4b7e"),D=a("7f67"),$=Object(v["a"])(k,s,i,!1,null,"704bd028",null);t["default"]=$.exports;f()($,"components",{QBtnToggle:x["a"],QInput:q["a"],QSelect:z["a"],QTable:P["a"],QBtn:C["a"],QUploader:T["a"],QDialog:w["a"],QCard:A["a"],QCardSection:F["a"],QCardActions:I["a"]}),f()($,"directives",{ClosePopup:D["a"]})}}]);