(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[18],{ad22:function(e,s,t){"use strict";t("d505")},d505:function(e,s,t){},d843:function(e,s,t){"use strict";t.r(s);var a=function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("div",{attrs:{id:"user"}},[a("h5",[e._v("Gestione utenti sistema")]),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:t("f32a")},on:{click:function(s){return e.newUser()}}}),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:t("40b4")},on:{click:function(s){return e.saveUser()}}}),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:t("c8ed")},on:{click:function(s){return e.deleteUser()}}}),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:t("5df3")},on:{click:function(s){return e.exit()}}}),a("ValidationObserver",{ref:"formUsers"},[a("q-form",{ref:"userForm",staticClass:"q-gutter-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Nome",immediate:"",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Nome"},model:{value:e.selectedUser.firstname,callback:function(s){e.$set(e.selectedUser,"firstname",s)},expression:"selectedUser.firstname"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Nome",immediate:"",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Cognome"},model:{value:e.selectedUser.lastname,callback:function(s){e.$set(e.selectedUser,"lastname",s)},expression:"selectedUser.lastname"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Codice fiscale",immediate:"",rules:"required|codfis"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Codice fiscale"},model:{value:e.selectedUser.codfis,callback:function(s){e.$set(e.selectedUser,"codfis",s)},expression:"selectedUser.codfis"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Indirizzo",immediate:"",rules:"required|address"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Indirizzo"},model:{value:e.selectedUser.address,callback:function(s){e.$set(e.selectedUser,"address",s)},expression:"selectedUser.address"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Email",immediate:"",rules:"required|email"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Email"},model:{value:e.selectedUser.email,callback:function(s){e.$set(e.selectedUser,"email",s)},expression:"selectedUser.email"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Telefono mobile",immediate:"",rules:"required|phone"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Telefono mobile"},model:{value:e.selectedUser.mobilephone,callback:function(s){e.$set(e.selectedUser,"mobilephone",s)},expression:"selectedUser.mobilephone"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Username",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Username"},model:{value:e.selectedUser.username,callback:function(s){e.$set(e.selectedUser,"username",s)},expression:"selectedUser.username"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Password",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-input",{attrs:{label:"Password"},model:{value:e.selectedUser.password,callback:function(s){e.$set(e.selectedUser,"password",s)},expression:"selectedUser.password"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Ruolo",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){var t=s.errors;return[a("q-select",{attrs:{label:"Ruolo",options:e.roles},on:{input:e.changeRole},model:{value:e.selectedRole,callback:function(s){e.selectedRole=s},expression:"selectedRole"}}),a("span",{staticClass:"error"},[e._v(e._s(t[0]))])]}}])})],1)])])],1),a("q-table",{attrs:{title:"Utenti",data:e.users,columns:e.columnsTableUsers,"row-key":"id","virtual-scroll":"",pagination:e.pagination,"rows-per-page-options":[5,10,15]},on:{"update:pagination":function(s){e.pagination=s},"row-click":e.openUser},scopedSlots:e._u([{key:"header",fn:function(s){return[a("q-tr",{attrs:{props:s}},[a("q-th",{attrs:{"auto-width":""}}),e._l(s.cols,(function(t){return a("q-th",{key:t.name,attrs:{props:s}},[e._v(e._s(t.label))])}))],2)]}},{key:"body",fn:function(s){return[a("q-tr",{class:s.row.state,attrs:{props:s}},[a("q-td",{attrs:{"auto-width":""}},[a("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t("d8f6")},on:{click:function(t){return e.openUser(s.row)}}}),a("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t("a3a3")},on:{click:function(t){return e.activateUser(s.row)}}}),a("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t("9b70")},on:{click:function(t){return e.suspendUser(s.row)}}}),a("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:t("c8ed")},on:{click:function(t){return e.deleteUser(s.row)}}})]),e._l(s.cols,(function(t){return a("q-td",{key:t.name,attrs:{props:s}},[e._v(e._s(t.value))])}))],2)]}}])})],1)},r=[],i=t("2f62"),l=t("4360"),o=t("7bb1"),n=(t("2ee0"),{data(){return{selectedUser:{},selectedRole:{},users:[],pagination:{rowsPerPage:0},roles:[{label:"Ufficio",value:"manager",description:"Ufficio azienda"},{label:"Tecnico interno",value:"technician",description:"Tecnico azienda"},{label:"Installatore esterno",value:"installer",description:"Installatore esterno"},{label:"Commerciale",value:"seller",description:"Rappresentante commerciale esterno"},{label:"Administrator",value:"admin",description:"Amministrazione sistema"}],columnsTableUsers:[{name:"actions",label:"Azioni"},{name:"firstname",label:"Nome",field:e=>e.firstname,sortable:!0},{name:"lastname",label:"Cognome",field:e=>e.lastname,sortable:!0},{name:"username",label:"Indirizzo",field:e=>e.username,sortable:!0},{name:"phone",label:"Telefono",field:e=>e.mobilephone,sortable:!0},{name:"email",label:"Email",field:e=>e.email,sortable:!0},{name:"createdAt",label:"Data inserimento",field:e=>e.createdAt,sortable:!0}]}},methods:{newUser:function(){this.selectedUser={}},openUser:function(e){this.selectedUser=e,this.roles.forEach((s=>{s.value===e.role&&(this.selectedRole=s)}))},saveUser:function(){console.log(this.selectedUser),this.$axios.post("/adminarea/user/update",{user:this.selectedUser}).then((e=>{"OK"===e.data.status?(this.selectedUser=e.data.user,this.makeToast(e.data.msg)):this.makeToast(e.data.msg)})).catch((e=>{console.log(e)}))},deleteUser:function(e){const s=confirm("Confermi la cancellazione?");s&&this.$axios.post("/adminarea/user/delete",{user:e}).then((s=>{"OK"===s.data.status?(this.users.forEach(((s,t,a)=>{s.id===e.id&&this.users.splice(t,1)})),this.selectedService={},this.makeToast(s.data.msg)):this.makeToast(s.data.msg)})).catch((e=>{console.log(e)}))},getUserData:function(){this.selectedUser=Object.assign({},this.$store.state.user),this.getAllUsers()},getAllUsers:function(){this.$axios.post("/adminarea/user/getall",{}).then((e=>{"OK"===e.data.status&&(this.users=e.data.users,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},activateUser:function(e){e.state="active",this.$axios.post("/adminarea/user/update",{user:e}).then((e=>{"OK"===e.data.status&&(this.selectedUser=e.data.user,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},suspendUser:function(e){e.state="suspended",this.$axios.post("/adminarea/user/update",{user:e}).then((e=>{"OK"===e.data.status&&(this.selectedUser=e.data.user,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},changeRole(){this.selectedUser.role=this.selectedRole.value},exit:function(){this.$router.push("/AdminDashboard")},makeToast(e){this.$q.notify({color:"green-4",textColor:"white",icon:"info",message:e})}},components:{ValidationProvider:o["b"],ValidationObserver:o["a"]},computed:Object(i["b"])({user:"user"}),created(){this.getAllUsers()},beforeRouteEnter(e,s,t){var a=l["a"].state.user;console.log(a),"admin"===a.role?t():t("/Login")}}),c=n,d=(t("ad22"),t("2877")),u=t("0378"),m=t("27f9"),p=t("ddd8"),f=t("eaac"),h=t("bd08"),v=t("357e"),b=t("db86"),U=t("eebe"),g=t.n(U),k=Object(d["a"])(c,a,r,!1,null,"de0983b8",null);s["default"]=k.exports;g()(k,"components",{QForm:u["a"],QInput:m["a"],QSelect:p["a"],QTable:f["a"],QTr:h["a"],QTh:v["a"],QTd:b["a"]})}}]);