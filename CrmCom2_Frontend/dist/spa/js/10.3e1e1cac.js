(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"2b8c":function(e,t,n){},d187:function(e,t,n){"use strict";n("2b8c")},f2cc:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"deviceBackbone"}},[a("h6",[e._v("Gestione eventi di manutenzione")]),a("p",[a("b",[e._v("Sito "+e._s(e.selectedSiteBackbone.description))])]),a("p",[a("b",[e._v("Dispositivo "+e._s(e.selectedDeviceBackbone.description))])]),a("q-table",{attrs:{title:"Eventi di manutenzione",data:e.maintenanceEvents,columns:e.columnsTablemanteinanceEvents,"row-key":"id",filter:e.filterMaintenanceEvent,"virtual-scroll":"",pagination:e.initialPagination,"rows-per-page-options":[0],"no-data-label":"nessun risultato","no-results-label":"nessun risultato"},on:{"row-click":e.openMaintenanceEvent},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Ricerca"},model:{value:e.filterMaintenanceEvent,callback:function(t){e.filterMaintenanceEvent=t},expression:"filterMaintenanceEvent"}},[a("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1)]},proxy:!0},{key:"header",fn:function(t){return[a("q-tr",{attrs:{props:t}},[a("q-th",{attrs:{"auto-width":""}}),e._l(t.cols,(function(n){return a("q-th",{key:n.name,attrs:{props:t}},[e._v(e._s(n.label))])}))],2)]}},{key:"body",fn:function(t){return[a("q-tr",{class:t.row.state,attrs:{props:t}},[a("q-td",{attrs:{"auto-width":""}},[a("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:n("d8f6")},on:{click:function(n){return e.openMaintenanceEvent(t.row)}}}),a("img",{staticStyle:{width:"32px",height:"32px",xfill:"gray"},attrs:{src:n("c8ed")},on:{click:function(n){return e.deleteMaintenanceEvent(t.row)}}})]),e._l(t.cols,(function(n){return a("q-td",{key:n.name,attrs:{props:t}},[e._v(e._s(n.value))])}))],2)]}}])}),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:n("f32a")},on:{click:e.newMaintenanceEvent}}),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:n("40b4")},on:{click:e.saveMaintenanceEvent}}),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:n("c8ed")},on:{click:e.deleteMaintenanceEvent}}),a("img",{staticStyle:{width:"48px",height:"48px"},attrs:{src:n("5df3")},on:{click:e.exit}}),a("ValidationObserver",{ref:"FormMaintenanceEvent"},[a("q-form",{ref:"MaintenanceEventForm",staticClass:"q-gutter-md"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Descrizione",immediate:"",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[a("q-input",{attrs:{label:"Descrizione"},model:{value:e.selectedMaintenanceEvent.description,callback:function(t){e.$set(e.selectedMaintenanceEvent,"description",t)},expression:"selectedMaintenanceEvent.description"}}),a("span",{staticClass:"error"},[e._v(e._s(n[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Intervallo in giorni",immediate:"",rules:"required|integer"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[a("q-input",{attrs:{label:"Intervallo in giorni"},model:{value:e.selectedMaintenanceEvent.daysInterval,callback:function(t){e.$set(e.selectedMaintenanceEvent,"daysInterval",t)},expression:"selectedMaintenanceEvent.daysInterval"}}),a("span",{staticClass:"error"},[e._v(e._s(n[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Tipo",immediate:"",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[a("q-input",{attrs:{label:"Tipo"},model:{value:e.selectedMaintenanceEvent.type,callback:function(t){e.$set(e.selectedMaintenanceEvent,"type",t)},expression:"selectedMaintenanceEvent.type"}}),a("span",{staticClass:"error"},[e._v(e._s(n[0]))])]}}])})],1),a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Data inizio",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[a("q-input",{attrs:{filled:""},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"event"}},[a("q-popup-proxy",{ref:"qDateProxy",attrs:{"transition-show":"scale","transition-hide":"scale"}},[a("q-date",{attrs:{locale:e.calendarLocale},model:{value:e.selectedMaintenanceEvent.begin,callback:function(t){e.$set(e.selectedMaintenanceEvent,"begin",t)},expression:"selectedMaintenanceEvent.begin"}},[a("div",{staticClass:"row items-center justify-end"},[a("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",color:"primary",flat:""}})],1)])],1)],1)]},proxy:!0}],null,!0),model:{value:e.selectedMaintenanceEvent.begin,callback:function(t){e.$set(e.selectedMaintenanceEvent,"begin",t)},expression:"selectedMaintenanceEvent.begin"}}),a("span",{staticClass:"error"},[e._v(e._s(n[0]))])]}}])})],1)]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[a("ValidationProvider",{attrs:{name:"Note",immediate:"",rules:""},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.errors;return[a("q-input",{attrs:{label:"Note e dettagli manutenzione",type:"textarea",rows:"5",cols:"20"},model:{value:e.selectedMaintenanceEvent.note,callback:function(t){e.$set(e.selectedMaintenanceEvent,"note",t)},expression:"selectedMaintenanceEvent.note"}}),a("span",{staticClass:"error"},[e._v(e._s(n[0]))])]}}])})],1)])])],1)],1)},i=[],s=(n("e01a"),n("4360")),c=n("7bb1"),o=n("2ee0"),l={data(){return{selectedSiteBackbone:{},selectedDeviceBackbone:{},selectedMaintenanceEvent:{},sitesBackbone:{},maintenanceEvents:[],filterMaintenanceEvent:"",initialPagination:{sortBy:"description",descending:!0,page:2,rowsPerPage:5},columnsTablemanteinanceEvents:[{name:"actions",label:"Azioni"},{name:"description",label:"Descrizione",field:e=>e.description,sortable:!0},{name:"type",label:"Tipo",field:e=>e.type,sortable:!0},{name:"state",label:"Stato",field:e=>e.state,sortable:!0},{name:"daysInterval",label:"Intervallo in giorni",field:e=>e.daysInterval,sortable:!0}],calendarLocale:{days:"Domenica_Linedì_Martedì_Mercoledì_Giovedì_Venerdì_Sabato".split("_"),daysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),firstDayOfWeek:1}}},components:{ValidationProvider:c["b"],ValidationObserver:c["a"]},computed:{siteDescription(e){return this.sitesBackbone[e.siteBackboneId]}},mounted(){o["a"].setup(),this.selectedSiteBackbone=Object.assign({},this.$store.state.siteBackbone),this.selectedDeviceBackbone=Object.assign({},this.$store.state.deviceBackbone),this.selectedMaintenanceEvent=Object.assign({},this.$store.state.MaintenanceEvent),null==this.selectedMaintenanceEvent&&(this.selectedMaintenanceEvent={}),this.getAllMaintenanceEvent()},methods:{onFiltered(e){this.totalRows=e.length,this.currentPage=1},getAllMaintenanceEvent(){this.$axios.post("/adminarea/maintenanceEvent/getall",{deviceBackbone:this.selectedDeviceBackbone}).then((e=>{"OK"===e.data.status&&(this.maintenanceEvents=e.data.maintenanceEvents,console.log(this.maintenanceEvents),this.totalRows=this.maintenanceEvents.length,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},newMaintenanceEvent(){this.selectedMaintenanceEvent={},this.selectedMaintenanceEvent.objData={},this.$store.commit("changeMaintenanceEvent",Object.assign({},this.selectedMaintenanceEvent)),this.makeToast("Insert new maintenance event.")},openMaintenanceEvent(e){this.selectedMaintenanceEvent=e,this.$store.commit("changeMaintenanceEvent",Object.assign({},this.selectedMaintenanceEvent))},saveMaintenanceEvent(){this.selectedMaintenanceEvent.id&&this.$axios.post("/adminarea/maintenanceEvent/update",{maintenanceEvent:this.selectedMaintenanceEvent}).then((e=>{"OK"===e.data.status?(this.selectedMaintenanceEvent=e.data.maintenanceEvent,this.$store.commit("changeMaintenanceEvent",Object.assign({},this.selectedMaintenanceEvent)),this.makeToast(e.data.msg),this.getAllMaintenanceEvent()):this.makeToast(e.data.msg,"danger")})).catch((e=>{console.log(e)})),this.selectedMaintenanceEvent.id||(console.log("New Insert"),console.log(this.selectedMaintenanceEvent),this.selectedMaintenanceEvent.objData={},this.selectedMaintenanceEvent.objData.device=this.selectedDeviceBackbone,this.$axios.post("/adminarea/maintenanceEvent/insert",{maintenanceEvent:this.selectedMaintenanceEvent}).then((e=>{"OK"===e.data.status?(this.selectedMaintenanceEvent=e.data.maintenanceEvent,this.$store.commit("changeMaintenanceEvent",Object.assign({},this.selectedMaintenanceEvent)),this.makeToast(e.data.msg),this.getAllMaintenanceEvent()):this.makeToast(e.data.msg,"danger")})).catch((e=>{console.log(e)})))},deleteMaintenanceEvent(e){const t=confirm("Confermi la cancellazione?");t&&this.$axios.post("/adminarea/maintenanceEvent/delete",{maintenanceEvent:e}).then((e=>{"OK"===e.data.status?(this.selectedMaintenanceEvent={},this.$store.commit("changeMaintenanceEvent",Object.assign({},this.selectedMaintenanceEvent)),this.makeToast(e.data.msg),this.getAllMaintenanceEvent()):this.makeToast(e.data.msg,"danger")})).catch((e=>{console.log(e)}))},makeToast(e){this.$q.notify({color:"green-4",textColor:"white",icon:"info",message:e})},exit(){this.$router.go(-1)}},computed:{monitorClassBackground(e){return e.state},classRowTableDevices(e){return e&&e.state?e.state:""}},beforeRouteEnter(e,t,n){var a=s["a"].state.user;console.log(a),"admin"===a.role||"manager"===a.role||"ufficio"===a.role||"technician"===a.role?n():n("/Login")}},r=l,d=(n("d187"),n("2877")),v=n("eaac"),u=n("27f9"),p=n("0016"),m=n("bd08"),h=n("357e"),b=n("db86"),E=n("0378"),g=n("7cbe"),M=n("52ee"),f=n("9c40"),_=n("7f67"),k=n("eebe"),y=n.n(k),w=Object(d["a"])(r,a,i,!1,null,null,null);t["default"]=w.exports;y()(w,"components",{QTable:v["a"],QInput:u["a"],QIcon:p["a"],QTr:m["a"],QTh:h["a"],QTd:b["a"],QForm:E["a"],QPopupProxy:g["a"],QDate:M["a"],QBtn:f["a"]}),y()(w,"directives",{ClosePopup:_["a"]})}}]);