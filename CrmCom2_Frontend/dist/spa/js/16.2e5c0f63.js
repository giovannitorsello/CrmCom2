(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{"1bbb":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"serviceTemplate"}},[i("h6",{staticClass:"h4 text-gray-900 mb-4"},[e._v("Configurazione Modelli di Servizio")]),i("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:a("f32a")},on:{click:function(t){return e.newServiceTemplate()}}}),i("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:a("40b4")},on:{click:function(t){return e.saveServiceTemplate()}}}),i("img",{staticStyle:{width:"32px",height:"32px"},attrs:{src:a("c8ed")},on:{click:function(t){return e.deleteServiceTemplate()}}}),i("ValidationObserver",{ref:"formServiceTemplate"},[i("q-form",{ref:"serviceForm",staticClass:"q-gutter-md"},[i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"Descrizione",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Descrizione"},model:{value:e.selectedServiceTemplate.description,callback:function(t){e.$set(e.selectedServiceTemplate,"description",t)},expression:"selectedServiceTemplate.description"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1),i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"Category",immediate:"",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-select",{attrs:{filled:"",label:"Categoria",options:e.serviceCategories},on:{input:e.changeCategory},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1),i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"Unità",immediate:"",rules:"required|alpha_spaces"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Unità"},model:{value:e.selectedServiceTemplate.unit,callback:function(t){e.$set(e.selectedServiceTemplate,"unit",t)},expression:"selectedServiceTemplate.unit"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1),i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"Intervallo di fatturazione",immediate:"",rules:"required|integer"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Intervallo fatturazione in giorni"},model:{value:e.selectedServiceTemplate.billingPeriod,callback:function(t){e.$set(e.selectedServiceTemplate,"billingPeriod",t)},expression:"selectedServiceTemplate.billingPeriod"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1)]),i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"Costo di attivazione",immediate:"",rules:"required|decimal"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Costo di attivazione"},model:{value:e.selectedServiceTemplate.activationPrice,callback:function(t){e.$set(e.selectedServiceTemplate,"activationPrice",t)},expression:"selectedServiceTemplate.activationPrice"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1),i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"Prezzo",immediate:"",rules:"required|decimal"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Prezzo"},model:{value:e.selectedServiceTemplate.price,callback:function(t){e.$set(e.selectedServiceTemplate,"price",t)},expression:"selectedServiceTemplate.price"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1),i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"IVA",immediate:"",rules:"required|decimal"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"IVA"},model:{value:e.selectedServiceTemplate.vat,callback:function(t){e.$set(e.selectedServiceTemplate,"vat",t)},expression:"selectedServiceTemplate.vat"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1)]),i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"G. avviso fattura",immediate:"",rules:"required|integer"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Giorni successivi all'invio fattura a partire dai quali viene prodotto l'avviso"},model:{value:e.selectedServiceTemplate.dayinvoicereminder,callback:function(t){e.$set(e.selectedServiceTemplate,"dayinvoicereminder",t)},expression:"selectedServiceTemplate.dayinvoicereminder"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1)]),i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"G. mancato pagamento",immediate:"",rules:"required|integer"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Giorni invio preavviso mancato pagamento"},model:{value:e.selectedServiceTemplate.nopaydaysbeforedeactivation,callback:function(t){e.$set(e.selectedServiceTemplate,"nopaydaysbeforedeactivation",t)},expression:"selectedServiceTemplate.nopaydaysbeforedeactivation"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1)]),i("div",{staticClass:"row"},[i("div",{staticClass:"col"},[i("ValidationProvider",{attrs:{name:"G. disatt. servizi",immediate:"",rules:"required|integer"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.errors;return[i("q-input",{attrs:{label:"Giorni invio preavviso disattivazione dei servizi"},model:{value:e.selectedServiceTemplate.dayforexpirationwarning,callback:function(t){e.$set(e.selectedServiceTemplate,"dayforexpirationwarning",t)},expression:"selectedServiceTemplate.dayforexpirationwarning"}}),i("span",{staticClass:"error"},[e._v(e._s(a[0]))])]}}])})],1)])])],1),i("hr",{staticClass:"separator"}),e.selectedServiceTemplate.objData?i("div",{attrs:{id:"serviceTemplateParameters"}},[i("h6",[e._v("Parametri servizio")]),e._l(e.selectedServiceTemplate.objData.parameters,(function(t,a){return i("div",{key:a,staticClass:"row"},[i("div",{staticClass:"col"},[i("q-input",{attrs:{label:a,id:a},model:{value:e.selectedServiceTemplate.objData.parameters[a],callback:function(t){e.$set(e.selectedServiceTemplate.objData.parameters,a,t)},expression:"selectedServiceTemplate.objData.parameters[primitiveName]"}})],1)])}))],2):e._e(),i("q-table",{attrs:{title:"Modelli di servizio",data:e.serviceTemplates,columns:e.columnsTableServiceTemplates,pagination:e.initialPagination,filter:e.txtFilter,"row-key":"id","virtual-scroll":""},scopedSlots:e._u([{key:"top-right",fn:function(){return[i("q-input",{attrs:{borderless:"",dense:"",debounce:"300",placeholder:"Ricerca"},model:{value:e.txtFilter,callback:function(t){e.txtFilter=t},expression:"txtFilter"}},[i("q-icon",{attrs:{slot:"append",name:"search"},slot:"append"})],1)]},proxy:!0},{key:"header",fn:function(t){return[i("q-tr",{attrs:{props:t}},[i("q-th",{attrs:{"auto-width":""}}),e._l(t.cols,(function(a){return i("q-th",{key:a.name,attrs:{props:t}},[e._v("\n          "+e._s(a.label)+"\n        ")])}))],2)]}},{key:"body",fn:function(t){return[i("q-tr",{attrs:{props:t}},[i("q-td",{attrs:{"auto-width":""}},[i("img",{staticStyle:{width:"32px",height:"32px",fill:"greenyellow"},attrs:{src:a("d8f6")},on:{click:function(a){return e.selectServiceTemplate(t.row)}}}),i("img",{staticStyle:{width:"32px",height:"32px",xfill:"green"},attrs:{src:a("a3a3")},on:{click:function(a){return e.activateServiceTemplate(t.row)}}}),i("img",{staticStyle:{width:"32px",height:"32px",xfill:"red"},attrs:{src:a("9b70")},on:{click:function(a){return e.suspendServiceTemplate(t.row)}}}),i("img",{staticStyle:{width:"32px",height:"32px",xfill:"gray"},attrs:{src:a("c8ed")},on:{click:function(a){return e.deleteServiceTemplate(t.row)}}})]),e._l(t.cols,(function(a){return i("q-td",{key:a.name,attrs:{props:t}},[e._v("\n          "+e._s(a.value)+"\n        ")])}))],2)]}}])})],1)},s=[],r=(a("e01a"),a("2f62")),l=a("4360"),c=a("7bb1"),o=(a("2ee0"),{data(){return{selectedServiceTemplate:{},serviceTemplates:[],serviceCategories:[],selectedCategoryObject:{},selectedCategory:{label:"",value:"",icon:""},txtFilter:"",initialPagination:{sortBy:"category",descending:!1,page:1,rowsPerPage:5},columnsTableServiceTemplates:[{name:"actions",label:"Azioni"},{name:"description",label:"Descrizione",field:"description",sortable:!0},{name:"code",label:"Codice",field:"code",sortable:!0},{name:"category",label:"Categoria",field:"category",sortable:!0},{name:"unit",label:"Unità",field:"unit",sortable:!0},{name:"price",label:"Prezzo",field:"price",sortable:!0},{name:"createdAt",label:"Data inserimento",field:"createdAt",sortable:!0},{name:"updatedAt",label:"Aggiornato il",field:"updatedAt",sortable:!0}]}},components:{ValidationProvider:c["b"],ValidationObserver:c["a"]},methods:{getServiceTemplateData:function(){this.getAllServiceTemplates(),this.getAllServiceCategories()},getAllServiceTemplates:function(){this.serviceTemplates=[],this.$axios.post("/adminarea/serviceTemplate/getall",{}).then((e=>{"OK"===e.data.status&&(this.serviceTemplates=e.data.serviceTemplates,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},getAllServiceCategories:function(){this.$axios.post("/adminarea/serviceTemplate/getAllServiceCategories",{}).then((e=>{"OK"===e.data.status&&(e.data.serviceCategories.forEach((e=>{this.serviceCategories.push({label:e.description,description:e.description,value:e,icon:""})})),this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},changeCategory:function(){this.selectedCategoryObject=this.selectedCategory.value,this.selectedServiceTemplate.category=this.selectedCategoryObject.value,console.log("Change service category"),console.log(this.selectedCategoryObject),console.log(this.selectedCategoryObject.value),this.selectedServiceTemplate.objData&&!this.selectedServiceTemplate.objData.parameters||this.selectedCategoryObject.parameters&&(console.log("Init objData parameters for serviceTemplate"),this.selectedServiceTemplate.objData||(this.selectedServiceTemplate.objData={}),this.selectedServiceTemplate.objData.parameters=this.selectedCategoryObject.parameters)},newServiceTemplate:function(){delete this.selectedServiceTemplate.id,this.saveServiceTemplate()},saveServiceTemplate:function(){let e="";this.selectedServiceTemplate.id&&""!==this.selectedServiceTemplate.id?e="/adminarea/serviceTemplate/update":(e="/adminarea/serviceTemplate/insert",this.selectedServiceTemplate.state="active"),this.$axios.post(e,{serviceTemplate:this.selectedServiceTemplate}).then((t=>{"OK"===t.data.status&&(this.selectedServiceTemplate=t.data.serviceTemplate,this.$store.commit("changeServiceTemplate",Object.assign({},this.selectedServiceTemplate)),"/adminarea/serviceTemplate/insert"===e&&this.serviceTemplates.push(this.selectedServiceTemplate)),this.makeToast(t.data.msg)})).catch((e=>{console.log(e)}))},selectServiceTemplate:function(e){this.selectedServiceTemplate=e,this.selectedCategory=this.serviceCategories.find((t=>t.label===e.category)),this.$store.commit("changeServiceTemplate",Object.assign({},this.selectedServiceTemplate)),console.log("Selected service templates is"),console.log(this.selectedServiceTemplate)},deleteServiceTemplate:function(e){const t=confirm("Confermi la cancellazione?");if(t){this.$parent;this.$axios.post("/adminarea/serviceTemplate/delete",{serviceTemplate:e}).then((t=>{"OK"===t.data.status&&(this.serviceTemplates.forEach(((t,a,i)=>{t.id===e.id&&this.serviceTemplates.splice(a,1)})),this.selectedServiceTemplate={},this.makeToast(t.data.msg))})).catch((e=>{console.log(e)}))}},activateServiceTemplate:function(e){e.state="active",this.$axios.post("/adminarea/serviceTemplate/update",{serviceTemplate:e}).then((e=>{"OK"===e.data.status&&(this.selectedServiceTemplate=e.data.serviceTemplate,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},suspendServiceTemplate:function(e){e.state="suspended",this.$axios.post("/adminarea/serviceTemplate/update",{serviceTemplate:e}).then((e=>{"OK"===e.data.status&&(this.selectedServiceTemplate=e.data.serviceTemplate,this.makeToast(e.data.msg))})).catch((e=>{console.log(e)}))},exit:function(){this.$parent.$emit("selectedCustomer")},makeToast(e){this.$q.notify({color:"green-4",textColor:"white",icon:"info",message:e})}},computed:Object(r["b"])({serviceTemplate:"serviceTemplate"}),created(){this.getServiceTemplateData()},beforeRouteEnter(e,t,a){var i=l["a"].state.user;"admin"===i.role?a():a("/Login")}}),n=o,d=(a("be50"),a("2877")),p=a("0378"),v=a("27f9"),m=a("ddd8"),u=a("eaac"),f=a("0016"),T=a("bd08"),h=a("357e"),g=a("db86"),S=a("eebe"),b=a.n(S),y=Object(d["a"])(n,i,s,!1,null,"9ca38878",null);t["default"]=y.exports;b()(y,"components",{QForm:p["a"],QInput:v["a"],QSelect:m["a"],QTable:u["a"],QIcon:f["a"],QTr:T["a"],QTh:h["a"],QTd:g["a"]})},"7f14":function(e,t,a){},be50:function(e,t,a){"use strict";a("7f14")}}]);